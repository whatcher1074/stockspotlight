<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>StockSpotlight - Professional Market Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
  <link href="/static/styles.css" rel="stylesheet">
  <script src="https://unpkg.com/htmx.org@1.9.5"></script>
</head>
<body class="container-fluid py-4">
  <header>
    <div class="row align-items-center">
      <div class="col-md-8">
        <h1 class="display-4 mb-2">
          üìà StockSpotlight
          <span class="htmx-indicator spinner-border spinner-border-sm ms-2" role="status" aria-hidden="true"></span>
        </h1>
        <p class="lead mb-0">Professional Real-Time Market Intelligence Dashboard</p>
      </div>
      <div class="col-md-4 text-md-end">
        <div class="d-flex flex-column align-items-md-end">
          <div class="badge bg-primary mb-2">Live Data Feed</div>
          <small class="text-muted">Last Updated: <span id="global-timestamp"></span></small>
        </div>
      </div>
    </div>
  </header>

  <!-- Top Row: Most Active Stocks (full width) -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">Most Active Stocks</h5>
        </div>
        <div class="card-body">
          <div id="most-active-stocks"
               hx-get="/data/most-active"
               hx-trigger="load, every 15s"
               hx-swap="innerHTML"
               hx-indicator="#most-active-stocks .htmx-indicator">
            <div class="text-center">
              <div class="spinner-border htmx-indicator" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
              <p>Loading most active stocks...</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Second Row: Gainers and Losers -->
  <div class="row mb-4">
    <div class="col-md-6">
      <div class="card h-100">
        <div class="card-header">
          <h5 class="card-title mb-0">Top Gainers</h5>
        </div>
        <div class="card-body">
          <div id="top-gainers"
               hx-get="/data/gainers"
               hx-trigger="load, every 20s"
               hx-swap="innerHTML"
               hx-indicator="#top-gainers .htmx-indicator">
            <div class="text-center">
              <div class="spinner-border htmx-indicator" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
              <p>Loading top gainers...</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-md-6">
      <div class="card h-100">
        <div class="card-header">
          <h5 class="card-title mb-0">Top Losers</h5>
        </div>
        <div class="card-body">
          <div id="top-losers"
               hx-get="/data/losers"
               hx-trigger="load, every 20s"
               hx-swap="innerHTML"
               hx-indicator="#top-losers .htmx-indicator">
            <div class="text-center">
              <div class="spinner-border htmx-indicator" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
              <p>Loading top losers...</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Third Row: Company Profile and News -->
  <div class="row mb-4">
    <div class="col-md-4">
      <div class="card h-100">
        <div class="card-header">
          <h5 class="card-title mb-0">Company Spotlight</h5>
        </div>
        <div class="card-body">
          <div id="company-profile"
               hx-get="/data/profile?symbol=AAPL"
               hx-trigger="load, every 30s"
               hx-swap="innerHTML"
               hx-indicator="#company-profile .htmx-indicator">
            <div class="text-center">
              <div class="spinner-border htmx-indicator" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
              <p>Loading company profile...</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-md-8">
      <div class="card h-100">
        <div class="card-header">
          <h5 class="card-title mb-0">Market News</h5>
        </div>
        <div class="card-body">
          <div id="news-feed"
               hx-get="/data/news?category=general"
               hx-trigger="load, every 60s"
               hx-swap="innerHTML"
               hx-indicator="#news-feed .htmx-indicator">
            <div class="text-center">
              <div class="spinner-border htmx-indicator" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
              <p>Loading latest news...</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Control Panel -->
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <div class="row align-items-center">
            <div class="col-md-8">
              <h6 class="mb-0">üéõÔ∏è Dashboard Controls</h6>
            </div>
            <div class="col-md-4 text-md-end">
              <span class="badge bg-secondary">Manual Override</span>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div class="row g-2">
            <div class="col-md-2">
              <button class="btn btn-success w-100" 
                      hx-get="/data/most-active" 
                      hx-target="#most-active-stocks"
                      hx-indicator="#most-active-stocks .htmx-indicator">
                üîÑ Stocks
              </button>
            </div>
            <div class="col-md-2">
              <button class="btn btn-success w-100" 
                      hx-get="/data/gainers" 
                      hx-target="#top-gainers"
                      hx-indicator="#top-gainers .htmx-indicator">
                üìà Gainers
              </button>
            </div>
            <div class="col-md-2">
              <button class="btn btn-danger w-100" 
                      hx-get="/data/losers" 
                      hx-target="#top-losers"
                      hx-indicator="#top-losers .htmx-indicator">
                üìâ Losers
              </button>
            </div>
            <div class="col-md-2">
              <button class="btn btn-info w-100" 
                      hx-get="/data/profile?symbol=AAPL" 
                      hx-target="#company-profile"
                      hx-indicator="#company-profile .htmx-indicator">
                üè¢ Profile
              </button>
            </div>
            <div class="col-md-2">
              <button class="btn btn-warning w-100" 
                      hx-get="/data/news" 
                      hx-target="#news-feed"
                      hx-indicator="#news-feed .htmx-indicator">
                üì∞ News
              </button>
            </div>
            <div class="col-md-2">
              <button class="btn btn-outline-secondary w-100" 
                      onclick="location.reload()">
                ‚ö° Reset
              </button>
            </div>
          </div>
          
          <div class="mt-3 p-3" style="background: rgba(255,255,255,0.02); border-radius: 8px; border: 1px solid var(--border-color);">
            <div class="row text-center">
              <div class="col-md-3">
                <small class="text-muted d-block">Most Active</small>
                <strong class="text-info">15s intervals</strong>
              </div>
              <div class="col-md-2">
                <small class="text-muted d-block">Gainers</small>
                <strong class="text-success">20s intervals</strong>
              </div>
              <div class="col-md-2">
                <small class="text-muted d-block">Losers</small>
                <strong class="text-danger">20s intervals</strong>
              </div>
              <div class="col-md-2">
                <small class="text-muted d-block">Profile</small>
                <strong class="text-warning">30s intervals</strong>
              </div>
              <div class="col-md-3">
                <small class="text-muted d-block">Market News</small>
                <strong class="text-info">60s intervals</strong>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Add timestamp updating script -->
  <script>
    function updateGlobalTimestamp() {
      const now = new Date();
      const timeString = now.toLocaleTimeString('en-US', { 
        hour12: false, 
        hour: '2-digit', 
        minute: '2-digit', 
        second: '2-digit' 
      });
      const timestampEl = document.getElementById('global-timestamp');
      if (timestampEl) {
        timestampEl.textContent = timeString;
      }
    }
    
    // Update timestamp every second
    setInterval(updateGlobalTimestamp, 1000);
    updateGlobalTimestamp(); // Initial call
  </script>

</body>
</html>